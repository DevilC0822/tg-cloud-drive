@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Manrope:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&family=Noto+Serif+SC:wght@500;600;700&display=swap');
@import 'tailwindcss';
@import '@heroui/styles';

/* 深色模式使用 class 驱动（配合 html.dark），便于在应用内切换主题 */
@custom-variant dark (&:where(.dark, .dark *));

/* 告诉 Tailwind 扫描源文件 */
@source '../**/*.{js,ts,jsx,tsx}';

/* 自定义主题 - 使用 hex 颜色覆盖 oklch */
@theme {
  /* 主题主色（唯一硬编码） */
  --theme-primary: #f4a48d;

  /* 基于主题主色自动计算出的语义色 */
  --theme-primary-strong: color-mix(in srgb, var(--theme-primary) 82%, black);
  --theme-primary-deep: color-mix(in srgb, var(--theme-primary) 70%, black);
  --theme-primary-ink: color-mix(in srgb, var(--theme-primary) 58%, black);
  --theme-primary-ink-strong: color-mix(in srgb, var(--theme-primary) 48%, black);
  --theme-primary-muted: color-mix(in srgb, var(--theme-primary) 70%, white);
  --theme-primary-soft: color-mix(in srgb, var(--theme-primary) 78%, white);
  --theme-primary-soft-hover: color-mix(in srgb, var(--theme-primary) 72%, white);
  --theme-primary-soft-press: color-mix(in srgb, var(--theme-primary) 68%, white);
  --theme-primary-soft-2: color-mix(in srgb, var(--theme-primary) 74%, white);

  /* 带透明度的主题色（用于 ring/bg/border） */
  --theme-primary-a08: color-mix(in srgb, var(--theme-primary) 8%, transparent);
  --theme-primary-a12: color-mix(in srgb, var(--theme-primary) 12%, transparent);
  --theme-primary-a16: color-mix(in srgb, var(--theme-primary) 16%, transparent);
  --theme-primary-a20: color-mix(in srgb, var(--theme-primary) 20%, transparent);
  --theme-primary-a24: color-mix(in srgb, var(--theme-primary) 24%, transparent);
  --theme-primary-a35: color-mix(in srgb, var(--theme-primary) 35%, transparent);
  --theme-primary-a55: color-mix(in srgb, var(--theme-primary) 55%, transparent);
  --theme-primary-a70: color-mix(in srgb, var(--theme-primary) 70%, transparent);

  /* HeroUI 语义色映射：确保 Checkbox 等组件不再回退默认蓝色 */
  --accent: var(--theme-primary);
  --accent-foreground: #1f1b16;
  --focus: var(--theme-primary);

  /* 弹窗动效令牌 */
  --motion-modal-enter-duration: 200ms;
  --motion-modal-exit-duration: 160ms;
  --motion-modal-enter-ease: cubic-bezier(0.22, 1, 0.36, 1);
  --motion-modal-exit-ease: cubic-bezier(0.4, 0, 1, 1);

  /* 品牌色（由主题色派生） */
  --color-gold: var(--theme-primary);
  --color-gold-dark: var(--theme-primary-strong);
  --color-brand-50: color-mix(in srgb, var(--theme-primary) 14%, white);
  --color-brand-100: color-mix(in srgb, var(--theme-primary) 24%, white);
  --color-brand-200: color-mix(in srgb, var(--theme-primary) 38%, white);
  --color-brand-500: var(--theme-primary);
  --color-brand-600: var(--theme-primary-strong);
  --color-brand-700: var(--theme-primary-deep);

  /* 覆盖 neutral 颜色为 hex 格式 */
  --color-neutral-50: #f7f8fb;
  --color-neutral-100: #eff2f6;
  --color-neutral-200: #dde3ea;
  --color-neutral-300: #c6ced8;
  --color-neutral-400: #9ca7b6;
  --color-neutral-500: #748091;
  --color-neutral-600: #5a6576;
  --color-neutral-700: #434d5d;
  --color-neutral-800: #2f3745;
  --color-neutral-900: #202733;
  --color-neutral-950: #141922;

  /* 其他颜色 */
  --color-white: #ffffff;
  --color-black: #000000;
  --color-red-500: #ef4444;
  --color-red-50: #fef2f2;
  --color-red-900: #7f1d1d;
  --color-green-500: #22c55e;
  --color-green-100: #dcfce7;
  --color-green-900: #14532d;
  --color-amber-500: #fb923c;
  --color-orange-500: #f97316;
  --color-pink-500: #ec4899;
  --color-purple-500: #a855f7;
  --color-blue-500: #3b82f6;
  --color-cyan-500: #06b6d4;
}

/* 基础样式 */
@layer base {
  * {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }

  html {
    font-family:
      'Manrope',
      'Noto Sans SC',
      'PingFang SC',
      'Microsoft YaHei',
      ui-sans-serif,
      system-ui,
      -apple-system,
      sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    touch-action: manipulation;
  }

  body {
    position: relative;
    background-color: #f6f8fb;
    background-image:
      radial-gradient(circle at 14% 6%, var(--theme-primary-a20), transparent 28%),
      radial-gradient(
        circle at 84% 8%,
        color-mix(in srgb, var(--theme-primary-soft) 28%, transparent),
        transparent 34%
      ),
      linear-gradient(
        142deg,
        rgba(255, 255, 255, 0.66) 0%,
        rgba(242, 246, 252, 0.94) 56%,
        rgba(233, 239, 247, 0.96) 100%
      );
    color: #1f2937;
    min-height: 100vh;
    line-height: 1.5;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    opacity: 0.23;
    background-image:
      repeating-linear-gradient(
        8deg,
        rgba(107, 114, 128, 0.05) 0,
        rgba(107, 114, 128, 0.05) 1px,
        transparent 1px,
        transparent 4px
      ),
      radial-gradient(circle at 20% 18%, rgba(255, 255, 255, 0.34), transparent 26%);
    mix-blend-mode: multiply;
  }

  .dark body {
    background-color: #0f1520;
    background-image:
      radial-gradient(circle at 12% 10%, color-mix(in srgb, var(--theme-primary) 18%, transparent), transparent 28%),
      radial-gradient(circle at 88% 4%, rgba(51, 65, 85, 0.42), transparent 30%),
      linear-gradient(142deg, rgba(17, 24, 39, 0.94) 0%, rgba(12, 18, 31, 0.98) 58%, rgba(8, 13, 23, 1) 100%);
    color: #f8fafc;
  }

  /* 深色模式下品牌“墨色”变量应偏亮，避免与深色背景对比不足 */
  .dark {
    --theme-primary-ink: var(--theme-primary-soft-hover);
    --theme-primary-ink-strong: var(--theme-primary-soft);
  }

  .dark body::before {
    opacity: 0.2;
    background-image:
      repeating-linear-gradient(
        8deg,
        color-mix(in srgb, var(--theme-primary-soft) 6%, transparent) 0,
        color-mix(in srgb, var(--theme-primary-soft) 6%, transparent) 1px,
        transparent 1px,
        transparent 4px
      ),
      radial-gradient(
        circle at 78% 22%,
        color-mix(in srgb, var(--theme-primary-soft) 13%, transparent),
        transparent 32%
      );
    mix-blend-mode: screen;
  }

  #root {
    min-height: 100vh;
    position: relative;
    z-index: 1;
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  h1,
  h2,
  h3,
  h4,
  .font-display {
    font-family: 'Noto Serif SC', 'Noto Sans SC', ui-serif, Georgia, serif;
    letter-spacing: -0.015em;
    font-weight: 600;
  }

  code,
  kbd,
  pre,
  .font-mono {
    font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  }

  ::selection {
    background-color: var(--theme-primary-a24);
  }

  /* 滚动条样式 */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background-color: rgba(120, 131, 146, 0.48);
    border-radius: 9999px;
    border: 2px solid transparent;
    background-clip: content-box;
  }

  .dark ::-webkit-scrollbar-thumb {
    background-color: rgba(99, 113, 132, 0.66);
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: rgba(99, 113, 132, 0.8);
  }

  .dark ::-webkit-scrollbar-thumb:hover {
    background-color: rgba(148, 163, 184, 0.78);
  }

  /* 触屏设备：隐藏自定义滚动条，使用系统原生滚动 */
  @media (pointer: coarse) {
    ::-webkit-scrollbar {
      display: none;
    }

    * {
      scrollbar-width: none;
    }
  }
}

/* 组件样式 */
@layer components {
  /* 玻璃态效果 */
  .glass {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0.1) 100%);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .dark .glass {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.4) 0%, rgba(15, 23, 42, 0.1) 100%);
    border-color: rgba(255, 255, 255, 0.08);
  }

  .glass-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0.2) 100%);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.4);
    border-radius: 1.5rem;
    box-shadow:
      0 16px 40px -16px rgba(15, 23, 42, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.6);
  }

  .dark .glass-card {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.4) 0%, rgba(15, 23, 42, 0.2) 100%);
    border-color: rgba(255, 255, 255, 0.1);
    border-radius: 1.5rem;
    box-shadow:
      0 16px 40px -16px rgba(0, 0, 0, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  .glass-sidebar {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.3) 100%);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.4);
  }

  .dark .glass-sidebar {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.4) 0%, rgba(15, 23, 42, 0.2) 100%);
    border-color: rgba(255, 255, 255, 0.1);
  }

  .glass-header {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0.2) 100%);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.4);
  }

  .dark .glass-header {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.4) 0%, rgba(15, 23, 42, 0.2) 100%);
    border-color: rgba(255, 255, 255, 0.1);
  }

  /* 传输中心：移动端吸顶顶栏（glass-header），桌面端卡片（glass-card） */
  .transfer-header-surface {
    background:
      linear-gradient(168deg, rgba(255, 255, 255, 0.58) 0%, rgba(243, 248, 252, 0.74) 100%), rgba(247, 250, 253, 0.72);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    border-bottom: 1px solid rgba(148, 163, 184, 0.3);
  }

  .dark .transfer-header-surface {
    background: linear-gradient(168deg, rgba(30, 41, 59, 0.74) 0%, rgba(15, 23, 42, 0.82) 100%), rgba(15, 23, 42, 0.76);
    border-color: rgba(100, 116, 139, 0.46);
  }

  @media (min-width: 768px) {
    .transfer-header-surface {
      background:
        linear-gradient(160deg, rgba(255, 255, 255, 0.68) 0%, rgba(243, 248, 252, 0.84) 100%), rgba(247, 250, 253, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.28);
      border-radius: 1.15rem;
      box-shadow:
        0 22px 48px -36px rgba(30, 41, 59, 0.38),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }

    .dark .transfer-header-surface {
      background:
        linear-gradient(160deg, rgba(30, 41, 59, 0.72) 0%, rgba(15, 23, 42, 0.84) 100%), rgba(15, 23, 42, 0.76);
      border-color: rgba(100, 116, 139, 0.44);
      box-shadow:
        0 22px 56px -36px rgba(4, 2, 1, 0.86),
        inset 0 1px 0 rgba(148, 163, 184, 0.12);
    }
  }

  /* 品牌强调按钮 */
  .btn-gold {
    background-color: var(--theme-primary);
    color: #1f1b16;
    font-weight: 600;
    border-radius: 0.75rem;
    padding: 0.55rem 1rem;
    cursor: pointer;
    transition:
      background-color 0.2s ease,
      transform 0.16s ease,
      box-shadow 0.2s ease;
  }

  @media (hover: hover) {
    .btn-gold:hover {
      background-color: var(--theme-primary-strong);
      box-shadow: 0 12px 28px -18px rgba(30, 41, 59, 0.42);
    }
  }

  .btn-gold:active {
    transform: translateY(1px);
  }

  /* 悬浮效果：仅在支持 hover 的设备上生效 */
  .hover-lift {
    transition:
      transform 0.2s ease,
      box-shadow 0.2s ease;
    cursor: pointer;
  }

  @media (hover: hover) {
    .hover-lift:hover {
      box-shadow: 0 18px 34px -24px rgba(15, 23, 42, 0.35);
      transform: translateY(-1px);
    }
  }

  /* 触屏设备：降低 backdrop-filter 复杂度 */
  @media (pointer: coarse) {
    .glass {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .glass-sidebar {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .glass-header {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .glass-card {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
  }

  /* 移动端简化 body::before 纹理 */
  @media (max-width: 767px) {
    body::before {
      opacity: 0.12;
    }
  }

  /* 拖拽区域激活 */
  .dropzone-active {
    border-color: var(--theme-primary);
    background-color: var(--theme-primary-a16);
  }

  /* 弹出菜单暖色实体背景（替代透明玻璃） */
  .popover-warm {
    background: linear-gradient(160deg, #fffbf7 0%, #faf4ee 100%);
    border: 1px solid var(--theme-primary-a24);
    box-shadow:
      0 20px 48px -16px rgba(62, 47, 34, 0.22),
      0 0 0 1px rgba(255, 255, 255, 0.6) inset;
  }

  .dark .popover-warm {
    background: linear-gradient(160deg, #201a15 0%, #181310 100%);
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow:
      0 20px 48px -16px rgba(0, 0, 0, 0.6),
      0 0 0 1px rgba(255, 255, 255, 0.04) inset;
  }
}

/* 动画 */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes modalBackdropIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes modalBackdropOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes modalDialogIn {
  from {
    opacity: 0;
    transform: translateY(8px) scale(0.992);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes modalDialogOut {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(6px) scale(0.994);
  }
}

@keyframes navActivePulse {
  0% {
    opacity: 0;
    transform: scale(0.985);
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--theme-primary) 0%, transparent);
  }
  45% {
    opacity: 1;
    transform: scale(1);
    box-shadow: 0 0 0 5px var(--theme-primary-a20);
  }
  100% {
    opacity: 0;
    transform: scale(1);
    box-shadow: 0 0 0 10px color-mix(in srgb, var(--theme-primary) 0%, transparent);
  }
}

@layer utilities {
  .animate-fadeIn {
    animation: fadeIn 0.22s ease-out;
  }

  .animate-slideUp {
    animation: slideUp 0.24s ease-out;
  }

  .animate-scaleIn {
    animation: scaleIn 0.22s ease-out;
  }

  .animate-navActivePulse {
    animation: navActivePulse 280ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .modal-backdrop-motion {
    will-change: opacity;
  }

  .modal-backdrop-motion[data-entering] {
    animation: modalBackdropIn var(--motion-modal-enter-duration) var(--motion-modal-enter-ease) both;
  }

  .modal-backdrop-motion[data-exiting] {
    animation: modalBackdropOut var(--motion-modal-exit-duration) var(--motion-modal-exit-ease) both;
  }

  .modal-dialog-motion {
    transform-origin: top center;
    will-change: transform, opacity;
  }

  .modal-dialog-motion[data-entering] {
    animation: modalDialogIn var(--motion-modal-enter-duration) var(--motion-modal-enter-ease) both;
  }

  .modal-dialog-motion[data-exiting] {
    animation: modalDialogOut var(--motion-modal-exit-duration) var(--motion-modal-exit-ease) both;
  }

  .animate-modalOverlayIn {
    animation: modalBackdropIn var(--motion-modal-enter-duration) var(--motion-modal-enter-ease) both;
  }

  .animate-modalOverlayOut {
    animation: modalBackdropOut var(--motion-modal-exit-duration) var(--motion-modal-exit-ease) both;
  }

  .animate-modalPanelIn {
    animation: modalDialogIn var(--motion-modal-enter-duration) var(--motion-modal-enter-ease) both;
  }

  .animate-modalPanelOut {
    animation: modalDialogOut var(--motion-modal-exit-duration) var(--motion-modal-exit-ease) both;
  }
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
